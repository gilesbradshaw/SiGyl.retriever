(function(){define(["Q","linq","breeze","knockout","breezeEntityManagers"],function(f,e,a,d,b){var c;c={changeData:function(i,j,g){var h;h=f.defer();b.getMe().done(function(k){return h.resolve(k.getStore(j.split(".")[0]).changeData(i,j,g))});return h.promise},deleteData:function(i,j,g){var h;h=f.defer();b.getMe().done(function(k){return h.resolve(k.getStore(j.split(".")[0]).deleteData(i,j,g))});return h.promise},get:function(h){var g;g=f.defer();b.getMe().done(function(i){var j;j=f.all(e.From(h).Select(function(n){var k,l,m,o,p;p=f.defer();l=i.getType(n.type);o=l.query;k=e.From(n.ids).Select(function(q){return a.Predicate.create("Id","==",q.Id)}).ToArray();o=o.where(a.Predicate.or(k));m=l.manager.executeQuery(o);m.done(function(q){var r;r=i.getStore(n.type);return p.resolve({Type:n.type,Ids:e.From(q.results).Select(function(t){var s;s=r.mergeData(n.type,t);return{Key:s.Id(),ParameterGroups:e.From(e.From(n.ids).Single(function(u){return u.Id.toString()===s.Id().toString()}).ParameterGroups).Select(function(u){return{Name:u.Name,Value:[s]}}).ToArray()}}).ToArray()})});m["catch"](function(){return p.reject()});return p.promise}).ToArray());j.done(function(k){return g.resolve(k)});return j["catch"](function(){return g.reject()})});return g.promise},getCollection:function(g){var h;h=f.defer();b.getMe().done(function(i){var j;j=f.all(e.From(g).Select(function(n){var k,l,m;m=f.defer();l=i.getCollectionType(n.type);k=f.all(e.From(n.collections).Select(function(o){var p,q,r;p=f.defer();r=l.collectionManager(o.collection);q=f.all(e.From(o.ids).Select(function(s){var t,u,v;t=f.defer();v=r.query(s.Id);u=f.all(e.From(s.ParameterGroups).Select(function(J){var F,G,H,I,K,L,M,N,w,x,y,z,A,B,C,D,E;K=f.defer();C=e.From(J.Parameters).Where(function(O){return O.Name==="filter"}).ToArray();for(w=0,z=C.length;w<z;w++){I=C[w];L=e.From(I.Values).Single(function(O){return O.Name==="property"}).Value;F=e.From(I.Values).Single(function(O){return O.Name==="operator"}).Value;N=e.From(I.Values).Single(function(O){return O.Name==="value"}).Value;v=v.where(L,F,N)}D=e.From(J.Parameters).Where(function(O){return O.Name==="order"}).ToArray();for(x=0,A=D.length;x<A;x++){I=D[x];if(e.From(I.Values).Any(function(O){return O.Name==="isDescending"&&O.Value})){G="orderByDesc"}else{G="orderBy"}M=e.From(I.Values).Single(function(O){return O.Name==="propertyName"}).Value;v=v[G](M)}E=e.From(J.Parameters).Where(function(O){return O.Name==="page"}).ToArray();for(y=0,B=E.length;y<B;y++){I=E[y];H=e.From(I.Values).Single(function(O){return O.Name==="page"}).Value;v=v.skip(H*10).take(10)}l.manager.executeQuery(v)["catch"](function(){return K.reject()}).done(function(O){return K.resolve({Name:J.Name,Collection:{data:O.results,metaData:{count:O.inlineCount}}})});return K.promise}).ToArray());u["catch"](function(){return t.reject()}).done(function(w){return t.resolve({Key:s.Id,ParameterGroups:w})});return t.promise}).ToArray());q["catch"](function(){return p.reject()}).done(function(s){return p.resolve({Collection:o.collection,Ids:s})});return p.promise}).ToArray());k["catch"](function(){return m.reject()}).done(function(o){return m.resolve({Type:n.type,Collections:o})});return m.promise}).ToArray());j.done(function(k){return h.resolve(k)});return j["catch"](function(){return h.reject()})});return h.promise}};return{getMe:function(){return c},initMe:function(g){return b.initMe(g)}}})}).call(this);
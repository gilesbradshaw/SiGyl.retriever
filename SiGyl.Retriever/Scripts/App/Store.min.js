(function(){define(["knockout","knockout.mapping","b64","linq","observableExtensions","utils","Q"],function(c,e,a,d,g,k,h){var i,b,f,j;j=function(m,n,l){return;k.getMe().process(m.property,(function(o){return function(p){if(p.name in n){if(c.isObservable(l[p.name])){return l[p.name](c.utils.unwrapObservable(n[p.name]))}else{return l[p.name]=n[p.name]}}}})(this));return l};b=function(l,m){return c.utils.unwrapObservable(m[l.key.propertyRef.name])};f=function(s,u,r,v){var t,w,x,l,m,n,o,p,q;x={};x.__proto__=s.__proto__;x._entityAspect=s._entityAspect;p=r.property;for(l=0,n=p.length;l<n;l++){w=p[l];x[w.name]=s[w.name]}k.getMe().process(r.flexibleRelations,function(y){return x[y.name]="flexible"});k.getMe().process(r.interModelRelations,function(y){return x[y.name]="intermodel"});k.getMe().process(r.navigationProperty,function(z){var y,A;y=u.associations[z.relationship.split(".")[1]];A=d.From(y.end).Single(function(B){return B.role===z.toRole});if(A.multiplicity==="*"){x[z.name]=g.getMe().manyObservable(x,r.name,z.name);return x[z.name]._navigationProperty=(function(B){return function(){return B}})(z)}else{return x[z.name]=g.getMe().singleObservable(x,z.name,r)}});if(r.histories){x._histories={};q=r.histories;for(m=0,o=q.length;m<o;m++){t=q[m];x._histories[t.name]="his"}}if(r.Of){x._runtime=v.runtime.rootObservable(s.RuntimeId,r.Of,true)}x.__conceptualModel=function(){return u};x.__entityType=function(){return r};return x};i=(function(){function l(m){var n;n=g.getMe().modelExtensions;this.mergeData=(function(o){return function(Y,Q){var M,N,O,P,R,S,T,U,V,W,X,Z,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;S=m.entityTypes[Y];V=b(S,Q);P=S.data[V]||(S.data[V]=f(Q,m,S,n));return P;for(p=0,t=Q.length;p<t;p++){Y=Q[p];R=m.entities[Y.Type];if(R){F=Y.Ids;for(q=0,u=F.length;q<u;q++){T=F[q];G=T.ParameterGroups;for(r=0,v=G.length;r<v;r++){W=G[r];if(typeof W.Value!=="string"){X=[];H=W.Value;for(s=0,w=H.length;s<w;s++){Z=H[s];U=b(R,Z);P=R.data[U]||(R.data[U]=f(Z,m,R,o.modelExtensions));if(!a.compare(Z.Timestamp,P.Timestamp())){j(R,Z,P);X.push(P)}}W.Value=X}}}I=Y.Collections;for(B=0,x=I.length;B<x;B++){M=I[B];O=$.Enumerable.From(R.navigationProperties).Single(function(aa){return aa.name===M.Collection}).to.type;N=m.entities[O];J=M.Ids;for(C=0,y=J.length;C<y;C++){T=J[C];K=T.ParameterGroups;for(D=0,z=K.length;D<z;D++){W=K[D];X=[];L=W.Collection.data;for(E=0,A=L.length;E<A;E++){Z=L[E];U=b(N,Z);P=N.data[U]||(N.data[U]=f(Z,m,N,o.modelExtensions));if(!a.compare(Z.Timestamp,P.Timestamp())){j(N,Z,P)}X.push(P)}W.Collection.data=X}}}}}return Q}})(this);this.changeData=(function(o){return function(r,t,u){var p,q,s;q=m.entityTypes[t.split(".")[0]];if(q){if(t.split(".").length===2){q=k.getMe().getDependent(q,t.split(".")[1]).entityType()}s=b(q,u);p=q.data[s]||(q.data[s]=f(u,m,q,n));if(!a.compare(c.utils.unwrapObservable(u.Timestamp),c.utils.unwrapObservable(p.Timestamp))){j(q,u,p)}return{id:r,type:t,value:p}}}})(this);this.deleteData=function(q,s,t){var o,p,r;p=m.entityTypes[s.split(".")[0]];if(p){if(s.split(".").length===2){p=k.getMe().getDependent(p,s.split(".")[1]).entityType()}r=b(p,t);o=p.data[r];delete p.data[r];return{id:q,type:s,value:o}}}}return l})();return{initMe:function(){return h()},getMe:function(){return i}}})}).call(this);
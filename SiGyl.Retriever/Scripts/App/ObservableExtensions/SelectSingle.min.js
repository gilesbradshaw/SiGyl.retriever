(function(){define(["jquery","knockout","listenToken","observableExtensions.extender","linq"],function(a,c,e,b,d){return c.extenders.selectSingle=function(g,f){g.selectSingle=function(h,k){var i,j,l,m,n,o,p;l=void 0;p=void 0;m=f.entityType().name;g._addPagerInfo.source="SelectSingle";if(h.split(".")[0]==="_histories"){j=h.split(".")[1];if(!a.Enumerable.From(f.entityType().histories).Any(function(q){return q.name===j})){throw"selectMany did not find a history of type "+j+" for "+m}o=f.observableExtensions.observableExtensions.history.rootObservable(0,j)}else{i=a.Enumerable.From(f.entityType().navigationProperties).Single(function(q){return q.name===h}).to.referentialConstraints[0].to[0];o=f.manySingleObservable(f.conceptualModel.entities[a.Enumerable.From(f.entityType().navigationProperties).Single(function(q){return q.name===h}).to.type]).base()()}n=o._onDisposed;o._onDisposed=function(){if(n){n()}if(p){p.dispose();return p=void 0}};if(k){k(g)}o._extendListenToken(function(q){return function(){var r,s,t;r=true;if(!p){p=g.subscribe(function(u){if(p){l.recycling=r;l.recycling=true;l.relistening=true;r=false;f.listener.listen(l);return f.listener.cycle()}})}l=q();t=l._modifyRetrieveRequest;s=function(u){return function(v){if(u){u(v)}o=a.Enumerable.From(v).Single(function(w){return w.Name==="id"}).Values=a.Enumerable.From(g()).Select(function(w){return{Name:"id",Value:w[i]()}}).ToArray();return o}};l._modifyRetrieveRequest=s(t);if(g._mixinTo){l._mixinTo=function(u){return a.extend({},u,g._mixinTo(a.Enumerable.From(g()).SingleOrDefault(void 0,function(v){return v[i]()===u.Id()})))}}return l}})();return function(){return o}};return g}})}).call(this);
(function(){define(["jquery","knockout","listenToken","observableExtensions.extender","linq"],function(a,c,e,b,d){return c.extenders.selectMany=function(g,f){g.selectMany=function(h,k){var i,j,l,m,n,o,p;l=void 0;p=void 0;m=f.entityType().name;g._addPagerInfo.source="SelectMany";if(h.split(".")[0]==="_histories"){i="RuntimeId";j=h.split(".")[1];if(!a.Enumerable.From(f.entityType().histories).Any(function(q){return q.name===j})){throw"selectMany did not find a history of type "+j+" for "+m}o=f.observableExtensions.observableExtensions.history.rootObservable(0,j)}else{i=a.Enumerable.From(f.entityType().navigationProperties).Single(function(q){return q.name===h}).to.referentialConstraints[0].to[0];o=f.manyObservable({Id:function(){return 0}},f.entityType().name,h,f.entityType()).base("selectMany:"+h)()}n=o._onDisposed;o._onDisposed=function(){if(n){n()}if(p){p.dispose();return p=void 0}};if(k){k(g)}o._extendListenToken(function(q){return function(){var r,s,t,u;r=true;if(!p){p=g.subscribe(function(v){if(p){l.recycling=r;l.recycling=true;l.relistening=true;r=false;f.listener.listen(l);return f.listener.cycle()}})}l=q();t=l._modifyCollectionRetrieveRequest;u=l._modifyRetrieveRequest;s=function(v){return function(w){if(v){v(w)}o=a.Enumerable.From(w).Single(function(x){return x.Name==="id"}).Values=a.Enumerable.From(g()).Select(function(y){return{Name:"id",Value:y.Id()}}).ToArray();return o}};l._modifyCollectionRetrieveRequest=s(t);l._modifyRetrieveRequest=s(u);l.canAddData=function(v,w){var x;if(v.type===(""+m+"."+h)){x=[];l._modifyCollectionRetrieveRequest(x);o=a.Enumerable.From(a.Enumerable.From(x).Single(function(y){return y.Name==="id"}).Values).Any((function(y){return function(z){return z.Name==="id"&&z.Value===v.value[i]()}})(this));return o}};return l}})();return function(){return o}};return g}})}).call(this);
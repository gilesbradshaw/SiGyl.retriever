(function(){define(["linq","Q"],function(a,b){var c;c={process:function(i,g){var h,d,e,f;if(i){if(i.length!==void 0){f=[];for(d=0,e=i.length;d<e;d++){h=i[d];f.push(g(h))}return f}else{return g(i)}}},processModel:function(d){d.entityTypes={};c.process(d.entityType,function(e){e.model=d;e.data={};d.entityTypes[e.name]=e;e.navigationProperties={};return c.process(e.navigationProperty,function(f){return e.navigationProperties[f.name]=f})});d.associations={};c.process(d.association,function(e){return d.associations[e.name]=e});return d},getPrincipal:function(e,g){var d,f,h,i,j;f=e.navigationProperties[g];i=f.relationship.split(".")[1];d=e.model.associations[i];h=d.referentialConstraint.principal;return j={id:function(){return h.propertyRef.name},end:function(){return a.From(d.end).Single(function(k){return k.role===h.role})},type:function(){return j.end().type.split(".")[2]},entityType:function(){return e.model.entityTypes[j.type()]}}},getDependent:function(e,g){var d,f,h,i,j;f=e.navigationProperties[g];i=f.relationship.split(".")[1];d=e.model.associations[i];h=d.referentialConstraint.dependent;return j={id:function(){return h.propertyRef.name},end:function(){return a.From(d.end).Single(function(k){return k.role===h.role})},type:function(){return j.end().type.split(".")[2]},entityType:function(){return e.model.entityTypes[j.type()]}}}};return{initMe:function(){return b()},getMe:function(){return c}}})}).call(this);